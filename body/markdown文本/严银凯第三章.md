# 第三章 基于持久同调的倾斜时间序列分类方法

本章致力于解决现有时间序列分类算法在有效提取高维拓扑信息及捕捉时序动态特性方面存在的局限性。为此，提出了一种结合持久同调理论与时间倾斜策略的新型时间序列分类算法，称之为PHTSI算法。该算法的核心思想在于通过特定的数据变换增强时间序列的结构特性，并利用持久同调提取这些结构中的内在拓扑不变量，以期提升分类的准确性与鲁棒性。

## PHTSI算法框架

PHTSI算法的整体架构包含数据预处理、核心特征提取与分类三个主要阶段。其设计旨在从原始时间序列数据中发掘深层次的拓扑结构信息，并将其有效地应用于分类任务。

### 数据预处理

在进行特征提取之前，原始时间序列数据需经过一系列预处理步骤，以确保数据的规范性并构建适用于拓扑分析的表示形式。

#### 数据规范化

首先，对输入的时间序列数据进行规范化处理，例如采用最小-最大规范化方法，将数据尺度统一到特定区间。这一步骤有助于消除不同序列间因量纲差异可能导致的计算偏差。

#### 点云构建

随后，将一维时间序列转换为二维点云结构。对于原始时间序列中的每一个数据点 $a_t^i$，通过结合其后续点的差分信息，构造一个二维向量 $q_t^i = (a_t^i, a_{t+1}^i - a_t^i)$。这样的转换不仅保留了原始数据点的值，还融入了其局部变化趋势，初步揭示了序列的动态特性。

### 核心特征提取模块

此模块是PHTSI算法的核心，包括了时间序列的分割、结构增强、拓扑特征提取及表示等关键步骤。

#### 滑动窗口子序列划分

采用固定尺寸的滑动窗口及预设的滑动步长，将前一步构建的二维点云序列分割成若干个等长的子序列片段。这种局部化的处理方式有助于捕捉时间序列在不同阶段的局部模式，同时也能有效控制后续持久同调计算的复杂度。设窗口大小为 $w$，滑动步长为 $d$，则第 $i$ 个原始序列的第 $j$ 个子序列 $W_{i}^{j,1}$ 可以表示为：
$$ W_{i}^{j,1} = (q_{d \cdot j - d + 1}^{i}, q_{d \cdot j - d + 2}^{i}, \dots, q_{d \cdot j - d + w}^{i}) $$

#### 时间倾斜变换

时间倾斜变换是本算法的关键创新之一，其目的是对子序列进行结构增强，以揭示更丰富的时序依赖信息。对于每一个子序列 $W_{i}^{j,1}$，通过引入与时间顺序相关的线性函数进行变换，生成两个新的倾斜子序列。

令子序列 $W_{i}^{j,1}$ 的长度为 $w$。
第一个倾斜变换采用线性函数 $f_1(k) = k$（其中 $k$ 为点在子序列中的序号，从1到 $w$），作用于子序列中的每个点 $q_k'$ (代表 $W_{i}^{j,1}$ 中的第 $k$ 个点)：
$$ W_{i}^{j,2} = (1 \cdot q_1', 2 \cdot q_2', \dots, w \cdot q_w') $$
此变换增强了子序列中后续点的影响。

第二个倾斜变换采用线性函数 $f_2(k) = w - k + 1$，作用于子序列中的每个点 $q_k'$：
$$ W_{i}^{j,3} = (w \cdot q_1', (w-1) \cdot q_2', \dots, 1 \cdot q_w') $$
此变换则增强了子序列中初始点的影响。

通过这种方式，原始子序列 $W_{i}^{j,1}$ 及其两个倾斜版本 $W_{i}^{j,2}$ 和 $W_{i}^{j,3}$ 共同构成了后续拓扑分析的基础，使得算法能够从多个角度审视数据的内在结构。

#### 持久同调计算与持久性图生成

针对上述每个子序列（原始及倾斜后的），应用持久同调理论进行分析。首先，基于子序列中的点集构建Vietoris-Rips (VR)复形流。随着VR复形参数（通常为距离阈值 $\epsilon$）的增加，复形的拓扑结构（如连通分支、环、空腔等）会发生演化——产生、持续和消亡。持久同调能够追踪这些拓扑特征在不同尺度下的生命周期。

计算结果通常可视化为持久性图（Persistence Diagram, PD）。PD图是一个二维散点图，其中每个点 $(b, d)$ 代表一个拓扑特征， $b$ 是其出生时间（参数值）， $d$ 是其消亡时间。这些点揭示了数据在不同尺度下的拓扑不变量。

#### 拓扑特征表示：持久性中心

为了将PD图这种多点集表示转换为适用于机器学习模型的固定长度特征向量，本算法计算了持久性中心。对于一个给定的PD图，其持久性中心 $\Psi(\text{PD})$ 定义为图中所有点基于其生命周期长度 $(d-b)$ 的加权平均坐标：
$$ \Psi(\text{PD}) = \frac{\sum_{(b,d) \in \text{PD}} (d-b) \cdot (b,d)}{\sum_{(b,d) \in \text{PD}} (d-b)} $$
其中，坐标 $(b,d)$ 在实际计算中可能仅关注出生时间和死亡时间本身，或者其转换后的其他表示。每个子序列（原始及倾斜）都会计算其对应的持久性中心，这些中心共同构成了该原始时间序列样本的拓扑特征集。

### 分类模型训练与评估

将所有样本提取到的持久性中心特征向量汇集起来，构成特征矩阵。然后，选用随机森林等机器学习分类器对这些拓扑特征进行训练。模型的性能通过标准的评价指标（如分类准确率、F1分数等）在独立的测试集上进行评估。

## 算法稳定性考量

PHTSI算法的稳定性是其有效性的重要保障。从理论上分析了算法输出的持久性图对于输入时间序列微小扰动的鲁棒性。通过引入瓶颈距离（Bottleneck Distance）作为衡量持久性图之间差异的度量，并结合Hausdorff距离，证明了在原始时间序列受到有界扰动时，其通过PHTSI算法流程（包括点云构建、时间倾斜和VR复形过滤）得到的持久性图之间的瓶颈距离也受到相应约束。这表明算法所提取的拓扑特征对于一定程度的数据噪声和扰动具有稳定性。

## 实验验证与分析

为验证PHTSI算法的有效性，在多个公开的时间序列数据集（如UCR数据集）上进行了广泛的实验。实验设计包括：

* **参数敏感性分析**：研究滑动窗口大小、滑动步长等关键参数对算法性能的影响，并通过交叉验证等方法选取最优参数组合。
* **对比实验**：将PHTSI算法与多种经典及先进的时间序列分类算法（如DTW, EDR, MSM, Signature等）在准确率和F1分数等指标上进行比较。
* **消融实验**：分析时间倾斜等关键模块对算法整体性能的贡献。
* **时间复杂度分析**：评估算法的计算效率。

实验结果通常表明，PHTSI算法在多个数据集上能够取得具有竞争力的甚至更优的分类性能，尤其是在捕捉复杂时间序列结构方面展现出其优势。

## 本章小结

本章详细阐述了基于持久同调的倾斜时间序列分类算法（PHTSI）。该算法通过新颖的时间倾斜策略增强了时间序列子段的结构信息，并结合持久同调理论提取了鲁棒的拓扑特征。理论分析证明了算法的稳定性，实验结果验证了其在时间序列分类任务上的有效性和优越性。PHTSI算法为时间序列分析提供了一种新的视角，展示了拓扑数据分析在理解和处理复杂动态数据方面的潜力。


